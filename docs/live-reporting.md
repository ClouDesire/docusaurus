---
id: live-reporting
title: Live Reporting
sidebar_label: Live Reporting
---
A specific platform module is in charge of collecting, with a configurable
granularity (e.g. daily), the costs/revenues relating to all the pre-paid and
pay-per-use services sold through the marketplace.

This allows a **Live Reporting** functionality, which is essential in contexts
where the Cloudesire platform is not directly used to bill end customers,
but rather must provide 3rd-party systems (ERP) with "billing instructions".

## Contextualization

The default functioning of Cloudesire is to _staticize_ incomes related to:

- [Syndicated Products](syndication.md)
- [Docker Applications](docker.md)
- [VM products](vm.md)
- Public Tenants (AWS/GCE/Azure)
- Cloud Services

on a dedicated data-structure, named **proceeds**, which contains:

- _pre-paid_ incomes, that will be generated at the **beginning** of each
  billing period of the related subscription
- _post-paid_ (pay-per-use) incomes, that will be generated at the **end** of
  each billing period of the related subscription

 Depending on the billing frequency (monthly, bimonthly, yearly, etc.) of
 the running subscriptions, Cloudesire aggregates all the _proceeds' rows_
 related to each subscription, and periodically generates the related
 **invoices** to be issued to the end-customers.

 If the [Distribution and Channel Management](channel.md) module is active,
 the proceeds' rows will be accordingly _markupped_ along the parent-child chain:

 - the Parent will markup the _vendor costs_ (previously specified by the Vendors)
   by configuring the _wholesale prices_ for Distributors
 - the Distributors will markup the _wholesale prices_ (previously specified
   by the Parent) by configuring the _sell-in prices_ for Resellers
 - the Resellers will markup the _sell-in prices_ (previously specified
   by the Distributors) by configuring the _sell-out prices_ for end-customers

as a consequence, the invoices' rows will include the sell-out prices.

## Goals

Normally, Cloudesire directly invoices the end-customers, accordingly to their
running subscriptions' billing-cycles. This implies that "every day" a certain
number of invoices will be automatically generated by the platform.

In some specific use-cases, the platform owner could not be interested in using the
Cloudesire Invoicing Engine for different reasons, like for example:

 - he wants to leverage an external Invoicing Platform
 - he wants to schedule the invoicing, for *all the end-users at the same time*,
   by following a *custom calendar* (e.g. the first day of each month)

In those scenarios, the platform can be specially configured to:

- not directly invoice the end-users
- calculate, for each running subscription, the "proportional daily quota" of
  their related costs/incomes
- storicize, on a **live-proceeds** data-structure, the raw data
- allows a 3rd-party to retrieve the collected values via API

As a consequence, a typical approach to fulfill the previous use-case, it would
be to implement an API integration between the external Invoicing Platform and
Cloudesire in order to retrieve the *live-proceeds* collected in a certain
timeframe (e.g. the previous month).

## Functioning

The previously described **live reporting** functionality provides benefits for
different actors:

- the platform owner can invoice all the end-customers at the same time,
  regardless their subscriptions lifecycle, by using an external Invoicing
  Platform
- the end-customers can leverage a **live costs previews** functionality on
  their private Dashboards (of course, in this case, the default invoices list
  functionality would be disabled)

## Special behavior for Public Tenants and Cloud Services

Public Tenants (AWS, GCE, Azure) and Cloud Services require special handling
in the live-reporting approach.

It's good to remember that those kind of products don't require to pre-configure
the *classical* pricing model based on license-prices plus pre-paid and/or
pay-per-use [extra-resources](onboarding-extra-resources.md).

In fact, once a public tenant is provisioned for an end-customer, the platform
periodically collects all the costs related to his subscription by invoking the
hyperscaler billing/metering engine.

Therefore, for a certain tenant, the platform will collect **several types of
costs**, related to disparate kinds of services which was actually used by the
end-customers during the last billing period (e.g. compute instances, storage,
network resources, PaaS services, etc.).

As described before, by leveraging the [Channel Management](channel.md)
capabilities, the platform owner (Parent), the Distributors, and the Resellers
can apply their respective *markups* (on-top the collected costs) along the
chain.

The setup procedure of the *wholesale/sell-in/out markups* for Public Tenants
and Cloud Services is quite simple: a **generic cost-placeholder** can be
configured on the product-plans, and all the following markups configurations
can be done on it.

During the periodical **cost-collection** task, Cloudesire invokes the
hyperscalers APIs and retrieves:

- the resource/service **hourly unit-cost** -> this will be mapped as "vendor
  cost" in the Cloudesire data-model
- the resource/service **hourly unit-street-price** -> this will be mapped as
  "wholesale price" in the Cloudesire data-model
- the resource/service **usage time** -> this will be stored, multiplied
  by its related street-price, in a "proceeds row"

Another (optional) platform configuration can be used to apply a
**flat discount** (e.g. 2%) on all the retrieved unit-street-prices.
This allows to model special commercial agreements that a CSP could
have been signed with the platform owner.

As a consequence, all the following markups, which are configured on
the above mentioned *generic cost-placeholder*, will be applied starting
from the wholesale price (namely the **optionally discounted** street
prices) down to the chain, in order to calculate the final sell-out
prices to be applied to the end-customers.
